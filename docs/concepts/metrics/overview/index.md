# Metrics Overview

This section explains how TempoEval evaluates a temporal RAG system.

## System flow overview

```
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚            INPUT                    â”‚
                            â”‚  Query: "What happened in 2020?"    â”‚
                            â”‚  Documents: [doc1, doc2, doc3, ...] â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                                   â”‚                                   â”‚
          â–¼                                   â–¼                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 1: Extract    â”‚           â”‚  STEP 1: Extract    â”‚           â”‚  STEP 1: Extract    â”‚
â”‚       QFT           â”‚           â”‚       QFT           â”‚           â”‚       QFT           â”‚
â”‚                     â”‚           â”‚                     â”‚           â”‚                     â”‚
â”‚  ExtractionMethod:  â”‚           â”‚  ExtractionMethod:  â”‚           â”‚  ExtractionMethod:  â”‚
â”‚      REGEX          â”‚           â”‚    HEIDELTIME       â”‚           â”‚       LLM           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     â”‚           â”‚                     â”‚           â”‚                     â”‚
â”‚ "What happened in   â”‚           â”‚ "What happened in   â”‚           â”‚ "What happened in   â”‚
â”‚  2020?"             â”‚           â”‚  the pandemic?"     â”‚           â”‚  the financial      â”‚
â”‚      â†“              â”‚           â”‚      â†“              â”‚           â”‚  crisis?"           â”‚
â”‚ Regex: \b20\d{2}\b  â”‚           â”‚ HeidelTime tagger   â”‚           â”‚      â†“              â”‚
â”‚      â†“              â”‚           â”‚      â†“              â”‚           â”‚ LLM: "Extract years"â”‚
â”‚ QFT = {2020}        â”‚           â”‚ QFT = {2020,2021,   â”‚           â”‚      â†“              â”‚
â”‚                     â”‚           â”‚       2022}         â”‚           â”‚ QFT = {2008,2009}   â”‚
â”‚                     â”‚           â”‚                     â”‚           â”‚                     â”‚
â”‚ Speed: âš¡ FAST      â”‚           â”‚ Speed: ðŸ”µ MEDIUM    â”‚           â”‚ Speed: ðŸ”´ SLOW      â”‚
â”‚ Cost:  ðŸ’š FREE      â”‚           â”‚ Cost:  ðŸ’š FREE      â”‚           â”‚ Cost:  ðŸ’° $$$       â”‚
â”‚ Accuracy: ðŸ”µ MEDIUM â”‚           â”‚ Accuracy: ðŸ’š HIGH   â”‚           â”‚ Accuracy: ðŸ’š HIGH   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                                   â”‚                                   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â–¼
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                             â”‚           QFT = {2020}         â”‚
                             â”‚    (Query Focus Time - years)  â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                    SAME 3 METHODS FOR EACH DOC                        â”‚
          â–¼                                                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 2: Extract    â”‚                                               â”‚  STEP 2: Extract    â”‚
â”‚    DFT for doc1     â”‚                                               â”‚    DFT for docN     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     â”‚                   ...                         â”‚                     â”‚
â”‚ Doc1: "In 2020,     â”‚                                               â”‚ DocN: "The 1990s    â”‚
â”‚  COVID spread..."   â”‚                                               â”‚  saw great..."      â”‚
â”‚      â†“              â”‚                                               â”‚      â†“              â”‚
â”‚ REGEX/HEIDELTIME/LLMâ”‚                                               â”‚ REGEX/HEIDELTIME/LLMâ”‚
â”‚      â†“              â”‚                                               â”‚      â†“              â”‚
â”‚ DFTâ‚ = {2020,2021}  â”‚                                               â”‚ DFTâ‚™ = {1990-1999}  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                                                                       â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚          DFTs = [DFTâ‚, DFTâ‚‚, ..., DFTâ‚™]â”‚
                          â”‚   [{2020,2021}, {2019}, {1990-1999}]   â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                                   â”‚                                   â”‚
          â–¼                                   â–¼                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 3: Compute    â”‚           â”‚  STEP 3: Compute    â”‚           â”‚  STEP 3: Compute    â”‚
â”‚    METRIC           â”‚           â”‚    METRIC           â”‚           â”‚    METRIC           â”‚
â”‚                     â”‚           â”‚                     â”‚           â”‚                     â”‚
â”‚  _compute_focus_timeâ”‚           â”‚  _compute_llm       â”‚           â”‚  _compute_gold      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     â”‚           â”‚                     â”‚           â”‚                     â”‚
â”‚ Input:              â”‚           â”‚ Input:              â”‚           â”‚ Input:              â”‚
â”‚   QFT = {2020}      â”‚           â”‚   query = "..."     â”‚           â”‚   retrieved_ids     â”‚
â”‚   DFTs = [...]      â”‚           â”‚   docs = [...]      â”‚           â”‚   gold_ids          â”‚
â”‚                     â”‚           â”‚                     â”‚           â”‚                     â”‚
â”‚ Logic:              â”‚           â”‚ Logic:              â”‚           â”‚ Logic:              â”‚
â”‚   QFT âˆ© DFT > 0?    â”‚           â”‚   LLM judges each   â”‚           â”‚   retrieved âˆ© gold  â”‚
â”‚                     â”‚           â”‚   doc relevance     â”‚           â”‚                     â”‚
â”‚ Example:            â”‚           â”‚ Example:            â”‚           â”‚ Example:            â”‚
â”‚   {2020}âˆ©{2020,2021}â”‚           â”‚   "Is doc1 about    â”‚           â”‚   {doc1,doc2} âˆ©     â”‚
â”‚   = {2020} âœ“        â”‚           â”‚    2020?" â†’ Yes     â”‚           â”‚   {doc1,doc3}       â”‚
â”‚                     â”‚           â”‚                     â”‚           â”‚   = {doc1}          â”‚
â”‚ Output: 0.67        â”‚           â”‚ Output: 0.80        â”‚           â”‚ Output: 0.50        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Temporal query type classification

| Intent | Example query | Primary metric |
| --- | --- | --- |
| specific_time | "When did X happen?" | Temporal Precision |
| duration | "How long did X last?" | Duration Accuracy |
| recency | "What are the recent advances in X?" | Temporal Diversity |
| change_over_time | "How has X changed since Y?" | Temporal Coverage |
| order | "What happened first?" | Event Ordering |

Implemented `temporal_intent` values:
- `when`, `specific_time`
- `duration`
- `recency`, `ongoing_status`
- `change_over_time`, `trends_changes_and_cross_period`
- `order`, `before_after`, `timeline`
- `period_definition`
- `none`
